---
title: oauth2_token
type: processor
categories: ["Integration"]
---

<!--
     THIS FILE IS AUTOGENERATED!

     To make changes please edit the contents of:
     lib/processor/oauth2_token.go
-->

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

Retrieves an OAuth2 token using the `client credentials` token flow


<Tabs defaultValue="common" values={[
  { label: 'Common', value: 'common', },
  { label: 'Advanced', value: 'advanced', },
]}>

<TabItem value="common">

```yaml
# Common config fields, showing default values
oauth2_token:
  endpoint: ""
  client_id: ""
  client_secret: ""
  scopes: []
```

</TabItem>
<TabItem value="advanced">

```yaml
# All config fields, showing default values
oauth2_token:
  endpoint: ""
  client_id: ""
  client_secret: ""
  scopes: []
  metadata_key: ""
  parts: []
```

</TabItem>
</Tabs>

This processor will return a JSON object containing an OAuth2 token or optionally within a marshalled JSON in a metadata key.

## Examples

<Tabs defaultValue="Retrieve an OAuth2 token using the ` + "`client credentials`" + ` token flow" values={[
{ label: 'Retrieve an OAuth2 token using the ` + "`client credentials`" + ` token flow', value: 'Retrieve an OAuth2 token using the ` + "`client credentials`" + ` token flow', },
]}>

<TabItem value="Retrieve an OAuth2 token using the ` + "`client credentials`" + ` token flow">


We can retrieve the token, which is returned in a JSON object if no `metadata_key` is set,
using a branch processor and mapping the token in its `result_map`. If the `metadata_key` is set, the token 
is returned in a marshalled JSON.

The resulting OAuth2 token object has the fields `access_token`, `token_type` and `expiry`.

In order to have a different endpoints, client IDs or secrets for each object you can use function
interpolations described [here](/docs/configuration/interpolation#bloblang-queries), which are
calculated per message of a batch.


```yaml
pipeline:
  processors:
  - branch:
      processors:
      - oauth2_token:
          endpoint: https://my-identiy-server.foo.com
          client_id: my-client-id
          client_secret: my-client-secret
          scopes:
          - my-scope
      result_map: |-
        token = this
  - bloblang: |
      root = this
      access_token = token.access_token
      token_type = token.token_type
      expiry = token.expiry
```

</TabItem>
</Tabs>

## Fields

### `endpoint`

The OAuth2 endpoint.


Type: `string`  
Default: `""`  

### `client_id`

ClientID is the application's ID.


Type: `string`  
Default: `""`  

### `client_secret`

ClientSecret is the application's secret.


Type: `string`  
Default: `""`  

### `scopes`

Scope specifies optional requested permissions.


Type: `array`  
Default: `[]`  

### `metadata_key`

An optional metadata key to store the OAuth2Token token


Type: `string`  
Default: `""`  

### `parts`

An optional array of message indexes of a batch that the processor should apply to.
If left empty all messages are processed. This field is only applicable when
batching messages [at the input level](/docs/configuration/batching).

Indexes can be negative, and if so the part will be selected from the end
counting backwards starting from -1.


Type: `array`  
Default: `[]`  


